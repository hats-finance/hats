import React, { useContext } from "react";
import classNames from "classnames";
import ArrowIcon from "assets/icons/arrow.icon";
import CheckmarkIcon from "assets/icons/checkmark.icon";
import { VulnerabilityFormContext } from "./VulnerabilityForm";
import { Colors } from "constants/constants";
import { VulnerabilityStep } from "./types";
import "styles/Vulnerability/AccordionCard.scss";

interface IProps {
  id: number
  card: VulnerabilityStep
  title: string
  verified: boolean
  children: React.ReactNode
  disabled?: boolean
  extraInfoTitle?: string
  collapsed: boolean
}

export default function VulnerabilityFormCard({ id, card, title, verified, children, disabled, extraInfoTitle, collapsed }: IProps) {
  const { setCurrentStep } = useContext(VulnerabilityFormContext);
  const cardContentClass = classNames({
    "card-content-wrapper": true,
    "collapsed": collapsed
  })

  const topWrapperClass = classNames({
    "top-wrapper": true,
    "verified": verified,
    "disabled": disabled
  })

  return (
    <div className="accordion-card-wrapper">
      <div className={topWrapperClass} onClick={() => setCurrentStep(id)}>
        <span className="card-number">{verified ? <CheckmarkIcon /> : id + 1}</span>
        <span className={collapsed ? "card-title" : "card-title open"}>{title}</span>
        {extraInfoTitle && <span className="selected-project-name">{`(${extraInfoTitle})`}</span>}
        <div className={collapsed ? "arrow" : "arrow open"}><ArrowIcon fill={verified ? Colors.darkBlue : Colors.turquoise} /></div>
      </div>
      <div className={cardContentClass}>{children}</div>
    </div>
  )
}
